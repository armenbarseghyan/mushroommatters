{%- comment -%}
  SEO Meta Tags for Mushroom Matters
  Includes title, description, Open Graph, Twitter Cards
{%- endcomment -%}

{%- liquid
  assign page_title = page_title | default: shop.name
  assign page_description = page_description | default: shop.description
  
  if template contains 'product'
    assign page_title = product.title | append: ' — ' | append: shop.name
    assign page_description = product.description | strip_html | truncate: 160
  elsif template contains 'collection'
    assign page_title = collection.title | append: ' — ' | append: shop.name
    assign page_description = collection.description | default: 'Shop ' | append: collection.title | append: ' at ' | append: shop.name
  elsif template contains 'article'
    assign page_title = article.title | append: ' — ' | append: shop.name
    assign page_description = article.excerpt | default: article.content | strip_html | truncate: 160
  elsif template contains 'page'
    assign page_title = page.title | append: ' — ' | append: shop.name
    assign page_description = page.content | strip_html | truncate: 160
  endif
-%}

<!-- Primary Meta Tags -->
<title>{{ page_title | escape }}</title>
<meta name="title" content="{{ page_title | escape }}">
<meta name="description" content="{{ page_description | escape }}">
<meta name="keywords" content="mushroom extracts, Lion's Mane, Reishi, Cordyceps, medicinal mushrooms, beta-glucans, premium supplements">
<meta name="author" content="{{ shop.name | escape }}">
<meta name="robots" content="index, follow">
<meta name="language" content="{{ request.locale.iso_code }}">
<meta name="revisit-after" content="7 days">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="{% if template contains 'product' %}product{% elsif template contains 'article' %}article{% else %}website{% endif %}">
<meta property="og:url" content="{{ canonical_url }}">
<meta property="og:title" content="{{ page_title | escape }}">
<meta property="og:description" content="{{ page_description | escape }}">
<meta property="og:site_name" content="{{ shop.name | escape }}">
<meta property="og:locale" content="{{ request.locale.iso_code }}">

{%- if template contains 'product' -%}
<meta property="og:image" content="{{ product.featured_image | image_url: width: 1200 }}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="{{ product.featured_image.alt | escape }}">
<meta property="product:price:amount" content="{{ product.price | money_without_currency | remove: ',' }}">
<meta property="product:price:currency" content="{{ cart.currency.iso_code }}">
<meta property="product:availability" content="{% if product.available %}in stock{% else %}out of stock{% endif %}">
<meta property="product:condition" content="new">
<meta property="product:brand" content="{{ product.vendor | escape }}">
<meta property="product:category" content="{{ product.type | escape }}">
{%- elsif template contains 'article' -%}
<meta property="og:image" content="{{ article.image | image_url: width: 1200 }}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="{{ article.image.alt | escape }}">
<meta property="article:published_time" content="{{ article.published_at | date: '%Y-%m-%dT%H:%M:%S%z' }}">
<meta property="article:modified_time" content="{{ article.updated_at | date: '%Y-%m-%dT%H:%M:%S%z' }}">
<meta property="article:author" content="{{ article.author | escape }}">
<meta property="article:section" content="Blog">
{%- elsif template contains 'index' -%}
<meta property="og:image" content="{{ settings.logo | image_url: width: 1200 }}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="{{ shop.name | escape }} logo">
{%- endif -%}

<!-- Twitter -->
<meta name="twitter:card" content="{% if template contains 'product' %}product{% else %}summary_large_image{% endif %}">
<meta name="twitter:url" content="{{ canonical_url }}">
<meta name="twitter:title" content="{{ page_title | escape }}">
<meta name="twitter:description" content="{{ page_description | escape }}">
{%- if template contains 'product' -%}
<meta name="twitter:image" content="{{ product.featured_image | image_url: width: 1200 }}">
<meta name="twitter:image:alt" content="{{ product.featured_image.alt | escape }}">
<meta name="twitter:label1" content="Price">
<meta name="twitter:data1" content="{{ product.price | money }}">
<meta name="twitter:label2" content="Availability">
<meta name="twitter:data2" content="{% if product.available %}In Stock{% else %}Out of Stock{% endif %}">
{%- elsif template contains 'index' -%}
<meta name="twitter:image" content="{{ settings.logo | image_url: width: 1200 }}">
<meta name="twitter:image:alt" content="{{ shop.name | escape }} logo">
{%- endif -%}

<!-- Additional SEO Meta Tags -->
<meta name="theme-color" content="#1a1a1a">
<meta name="msapplication-TileColor" content="#1a1a1a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="{{ shop.name | escape }}">

<!-- Canonical URL -->
<link rel="canonical" href="{{ canonical_url }}">

<!-- Alternate Language Versions -->
{%- for locale in shop.published_locales -%}
  {%- unless locale.iso_code == request.locale.iso_code -%}
    <link rel="alternate" hreflang="{{ locale.iso_code }}" href="{{ canonical_url | replace: request.locale.iso_code, locale.iso_code }}">
  {%- endunless -%}
{%- endfor -%}

<!-- Preconnect to External Domains -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://connect.facebook.net">

<!-- DNS Prefetch -->
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//connect.facebook.net">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="{{ 'favicon.ico' | asset_url }}">
<link rel="icon" type="image/png" sizes="32x32" href="{{ 'favicon-32x32.png' | asset_url }}">
<link rel="icon" type="image/png" sizes="16x16" href="{{ 'favicon-16x16.png' | asset_url }}">
<link rel="apple-touch-icon" sizes="180x180" href="{{ 'apple-touch-icon.png' | asset_url }}">

<!-- Manifest -->
<link rel="manifest" href="{{ 'site.webmanifest' | asset_url }}">

<!-- Structured Data -->
{% render 'json-ld' %}
